<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="Interactive family tree visualizer for CryptoKitties. Explore breeding relationships, discover mewtation gems, and visualize kitty lineage." />

  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="CryptoKitties Family Graph" />
  <meta property="og:description" content="Interactive family tree visualizer for CryptoKitties. Explore breeding relationships, discover mewtation gems, and visualize kitty lineage." />
  <meta property="og:image" content="https://ck.innerlogics.com/images/og-image.png" />
  <meta property="og:url" content="https://ck.innerlogics.com/" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="CryptoKitties Family Graph" />
  <meta name="twitter:description" content="Interactive family tree visualizer for CryptoKitties. Explore breeding relationships and mewtation gems." />
  <meta name="twitter:image" content="https://ck.innerlogics.com/images/og-image.png" />

  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32.png">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest">
  <title>CryptoKitties Family Graph</title>

  <script src="https://cdn.jsdelivr.net/npm/vis-network@10.0.2/standalone/umd/vis-network.min.js"></script>


  <link rel="stylesheet" href="./css/styles.css">

  <script>
    // Edit these defaults. No query params are used.
    window.CK_GRAPH_DEFAULTS = {
      debugLevel: 2,

      // Proxy is used ONLY for CK API and CK absolute URLs.
      useProxy: false,          // Enable/disable CORS proxy
      proxyUrl: "https://www.example.com/ckproxy.php?url=",

      svgBaseUrl: "",           // If set, tries local SVGs first (probes automatically)
      dataUrl: "",
      svgFromApi: true,         // Load images from CK API (fallback when svgBaseUrl fails or not set)
      siteBaseUrl: "https://www.cryptokitties.co",

      // Embed mode links
      githubUrl: "https://github.com/nivs/crypto-kitties-family-graph",

      // Default JSON to load
      //svgBaseUrl: "./example/nivs/svg/",
      //dataUrl: "./example/nivs/nivs_kitties.json"
    };
  </script>
</head>

<body>
  <header>
    <div class="title">CryptoKitties Family Graph</div>
    <div class="controls">
      <input id="jsonUrl" class="input" placeholder="JSON URL (or leave blank and use file picker)" />
      <button class="btn primary" id="loadFromUrlBtn">Load JSON URL</button>
      <input id="filePicker" class="hidden" type="file" accept="application/json" />
      <button class="btn" id="loadFileBtn">Load JSON File</button>
      <span class="separator">|</span>
      <input id="kittyIdInput" class="input input-narrow" placeholder="Kitty ID(s)" />
      <button class="btn" id="loadKittyBtn">Load Kitty(s)</button>
      <span class="separator">|</span>
      <button class="btn" id="togglePhysicsBtn">Physics: on</button>
      <button class="btn" id="permalinkBtn" title="Copy permalink to clipboard">Permalink</button>
      <span class="pill" id="statsPill">No data loaded</span>
    </div>
  </header>

  <main>
    <div id="networkWrap">
      <div id="banner"></div>
      <div id="network"></div>
      <div id="tooltip" class="tooltip"></div>
      <div id="contextMenu" class="context-menu">
        <div class="context-menu-item" data-action="center">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M12 2v4M12 18v4M2 12h4M18 12h4"/></svg>
          Center on this kitty
        </div>
        <div class="context-menu-item" data-action="expand">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>
          Expand family
        </div>
        <div class="context-menu-separator"></div>
        <div class="context-menu-item" data-action="highlightOwner">
          <span class="menu-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg></span>
          <span class="menu-text">Highlight owner</span>
        </div>
        <div class="context-menu-item" data-action="openOwner">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
          Open owner page
        </div>
        <div class="context-menu-separator"></div>
        <div class="context-menu-item" data-action="startFresh">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/></svg>
          Start fresh with this kitty
        </div>
        <div class="context-menu-separator"></div>
        <div class="context-menu-item" data-action="copyId">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
          Copy kitty ID
        </div>
        <div class="context-menu-item" data-action="openCK">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
          Open kitty page
        </div>
      </div>
      <a href="https://www.innerlogics.com" target="_blank" rel="noopener" class="floating-logo" title="innerlogics.com">
        <img src="./images/innerlogics-logo.png" alt="innerlogics" />
      </a>
      <div class="nav-controls">
        <div class="nav-row">
          <button class="nav-btn hidden"></button>
          <button class="nav-btn" id="moveUpBtn" title="Pan up">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="18 15 12 9 6 15"></polyline></svg>
          </button>
          <button class="nav-btn hidden"></button>
        </div>
        <div class="nav-row">
          <button class="nav-btn" id="moveLeftBtn" title="Pan left">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg>
          </button>
          <button class="nav-btn" id="centerMineBtn" title="Center on my kitties">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M12 2v4M12 18v4M2 12h4M18 12h4"></path></svg>
          </button>
          <button class="nav-btn" id="moveRightBtn" title="Pan right">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
          </button>
        </div>
        <div class="nav-row">
          <button class="nav-btn hidden"></button>
          <button class="nav-btn" id="moveDownBtn" title="Pan down">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
          </button>
          <button class="nav-btn hidden"></button>
        </div>
        <div class="nav-row">
          <button class="nav-btn" id="zoomInBtn" title="Zoom in">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
          </button>
          <button class="nav-btn" id="fitBtn" title="Fit all nodes">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path></svg>
          </button>
          <button class="nav-btn" id="zoomOutBtn" title="Zoom out">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"></line></svg>
          </button>
        </div>
      </div>
      <div id="floatingPanel" class="floating-panel">
        <div class="floating-panel-header" id="floatingPanelHeader">
          <span class="panel-title">Selected Kitty</span>
          <button class="panel-btn" id="floatingPanelCollapse" title="Collapse">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="18 15 12 9 6 15"></polyline></svg>
          </button>
          <button class="panel-btn" id="floatingPanelClose" title="Close">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
          </button>
        </div>
        <div class="floating-panel-body">
          <div id="floatingSelectedBox" class="small">Click a kitty to select</div>
        </div>
        <div class="floating-panel-footer">
          <a href="#" id="floatingGithubLink" target="_blank" rel="noopener">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
            GitHub
          </a>
          <button type="button" id="floatingViewerLink" class="link-btn">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>
            Open in viewer
          </button>
        </div>
      </div>
      <noscript>
        <div class="noscript-msg">JavaScript is disabled or blocked. This viewer requires JS.</div>
      </noscript>
    </div>

    <aside>
      <div class="card">
        <h3>Status</h3>
        <div class="small" id="statusText">Loading viewer…</div>
      </div>

      <div class="card">
        <h3>Selected Kitty</h3>
        <div id="selectedBox" class="small">None</div>
      </div>

      <div class="card">
        <h3 class="collapsible" id="filtersToggle">Filters</h3>
        <div class="card-body" id="filtersBody">
          <div class="filter-controls">
            <div class="filter-row">
              <label class="filter-label">Generation Range</label>
              <div class="filter-range">
                <input type="number" id="generationMin" class="filter-input" placeholder="Min" min="0" />
                <span class="filter-range-sep">–</span>
                <input type="number" id="generationMax" class="filter-input" placeholder="Max" min="0" />
              </div>
            </div>
            <div class="filter-row">
              <label class="filter-label">Mewtations</label>
              <div class="filter-buttons">
                <button class="filter-btn" id="mewtationFilterAll" title="Show all mewtations">All</button>
                <button class="filter-btn gem-diamond" id="mewtationFilterDiamond" title="Diamond (1st discovery)">
                  <img src="./images/cattributes/mewtation-gems/diamond.svg" alt="Diamond" class="gem-filter-icon" />
                </button>
                <button class="filter-btn gem-gold" id="mewtationFilterGold" title="Gilded (2-10)">
                  <img src="./images/cattributes/mewtation-gems/gold.svg" alt="Gold" class="gem-filter-icon" />
                </button>
                <button class="filter-btn gem-silver" id="mewtationFilterSilver" title="Amethyst (11-100)">
                  <img src="./images/cattributes/mewtation-gems/silver.svg" alt="Silver" class="gem-filter-icon" />
                </button>
                <button class="filter-btn gem-bronze" id="mewtationFilterBronze" title="Lapis (101-500)">
                  <img src="./images/cattributes/mewtation-gems/bronze.svg" alt="Bronze" class="gem-filter-icon" />
                </button>
              </div>
            </div>
            <div class="filter-row filter-row-inline">
              <label class="filter-checkbox-label">
                <input type="checkbox" id="filterEdgeHighlight" />
                <span>Highlight edges between filtered kitties</span>
              </label>
            </div>
            <div class="filter-row filter-row-inline">
              <label class="filter-checkbox-label" title="Hover to highlight path from selected">
                <input type="checkbox" id="shortestPathMode" />
                <span>Highlight shortest path</span>
              </label>
            </div>
            <button class="btn btn-small" id="clearFiltersBtn">Clear Filters</button>
          </div>
        </div>
      </div>

      <div class="card">
        <h3 class="collapsible collapsed" id="settingsToggle">Settings</h3>
        <div class="card-body collapsed" id="settingsBody">
          <div class="kv settings-kv">
            <div class="k">Use Proxy</div>
            <div class="v"><input type="checkbox" id="useProxy" /></div>

            <div class="k">Proxy URL</div>
            <div class="v"><input id="apiProxyUrl" class="input input-full" /></div>

            <div class="k">Local SVG base</div>
            <div class="v"><input id="svgBaseUrl" class="input input-full" placeholder="e.g. ./svg/" /></div>

            <div class="k">API images</div>
            <div class="v"><input type="checkbox" id="svgFromApi" checked /></div>

            <div class="k">CK site base</div>
            <div class="v"><input id="siteBaseUrl" class="input input-full" /></div>

            <div class="k">Pre-fetch</div>
            <div class="v"><input type="checkbox" id="prefetchChildren" checked /></div>

            <div class="k">Auto-connect</div>
            <div class="v"><input type="checkbox" id="autoConnect" checked /></div>

            <div class="k">Layout</div>
            <div class="v">
              <select id="layoutSelect" class="input input-full">
                <option value="clustered" selected>Clustered</option>
                <option value="physics">Force Atlas</option>
                <option value="barnesHut">Barnes-Hut</option>
                <option value="repulsion">Repulsion</option>
                <option value="circle">Circle</option>
                <option value="hierarchicalUD">Sugiyama ↓</option>
                <option value="hierarchicalDU">Sugiyama ↑</option>
                <option value="hierarchicalLR">Sugiyama →</option>
              </select>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <h3 class="collapsible" id="examplesToggle">Examples</h3>
        <div class="card-body" id="examplesBody">
          <div class="examples-list">
            <a href="?dataUrl=./example/dragon/dragon_extended.json&svgBaseUrl=./example/dragon/svg/&selected=896775&examples=open" class="example-link">Dragon</a>
            <span class="example-desc">600 ETH (~$170k)</span>

            <a href="?dataUrl=./example/founders/founders.json&svgBaseUrl=./example/founders/svg/&examples=open" class="example-link">Founders</a>
            <span class="example-desc">Genesis + Gen 0</span>

            <a href="?dataUrl=./example/milestones/milestones.json&svgBaseUrl=./example/milestones/svg/&examples=open" class="example-link">Milestones</a>
            <span class="example-desc">100k & 500k</span>

            <a href="?dataUrl=./example/holidays/holidays.json&svgBaseUrl=./example/holidays/svg/&examples=open" class="example-link">Holidays</a>
            <span class="example-desc">Mistletoe & SantaClaws</span>

            <a href="?dataUrl=./example/fancies/fancies.json&examples=open" class="example-link">Fancies</a>
            <span class="example-desc">42 bred from recipes</span>

            <a href="?dataUrl=./example/purrstiges/purrstiges.json&examples=open" class="example-link">Purrstiges</a>
            <span class="example-desc">59 time-limited cats</span>

            <a href="?dataUrl=./example/tier_iii/tier_iii.json&mewtations=diamond,gold&filterEdges=true&examples=open" class="example-link">Tier III</a>
            <span class="example-desc">Very rare mewtations</span>

            <a href="?dataUrl=./example/tier_iiii/tier_iiii.json&mewtations=diamond&filterEdges=true&examples=open" class="example-link">Tier IIII</a>
            <span class="example-desc">Rarest mewtations</span>

            <a href="?dataUrl=./example/diamonds/diamonds.json&mewtations=all&filterEdges=true&examples=open" class="example-link">Diamonds</a>
            <span class="example-desc">First discoverers</span>

            <a href="?dataUrl=./example/gen0_diamonds/gen0_diamonds.json&mewtations=diamond&filterEdges=true&examples=open" class="example-link">Gen-0 Diamonds</a>
            <span class="example-desc">40 trait discoverers</span>

            <a href="?dataUrl=./example/exclusives/exclusives.json&examples=open" class="example-link">Exclusives</a>
            <span class="example-desc">317 celebrity cats</span>

            <a href="?dataUrl=./example/shortest_path/holiday_fancies.json&pathFrom=174756&pathTo=275808&examples=open" class="example-link">Path Demo</a>
            <span class="example-desc">Mistletoe → Santa</span>

            <a href="?dataUrl=./example/dragon/dragon_connected.json&svgBaseUrl=./example/dragon/svg/&selected=896775&shortestPath=true&examples=open" class="example-link">Dragon Path</a>
            <span class="example-desc">Hover for paths</span>

            <a href="?kitties=896775,1,4,18,100000,174756,275808,500000&examples=open" class="example-link">All Notable</a>
            <span class="example-desc">Full showcase (API)</span>
          </div>
        </div>
      </div>

      <div class="card card-bottom">
        <a href="https://github.com/nivs/crypto-kitties-family-graph" target="_blank" rel="noopener" class="github-link">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
          View on GitHub
        </a>
      </div>
    </aside>
  </main>

  <script src="./js/ck-family-graph.js"></script>
</body>
</html>